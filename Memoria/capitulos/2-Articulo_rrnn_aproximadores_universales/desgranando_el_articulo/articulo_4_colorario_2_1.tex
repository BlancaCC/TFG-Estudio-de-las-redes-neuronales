% !TeX root = ../../tfg.tex
% !TeX encoding = utf8
%
%***************************************************************
% Contenido del artículo 4: Colorario 2.1
%***************************************************************

% Resultado de teoría de la medida 
Trataremos ahora de generalizar la tesis expuesta en 
 el teorema \ref{teo:2_4_rrnn_densas_M} sobre las funciones medibles. 
 Para ello recordaremos el teorema de Lusin.
% Teorema de Lusin 
\begin{teorema}[Teorema de Lusin] \label{teo:Lusin}
    Si $\mu$ es una medida regular de Borel, $E$ un conjunto de medida finita 
    y $f$ una función medible en $E$ entonces
    para cualquier $\epsilon > 0$ existirá un conjunto compacto 
    $K$ en $E$ tal que $\mu(E \setminus C) \leq \epsilon$ y donde $f$ es continua en $K$. 
\end{teorema}
\begin{proof}
    Demostración en páginas 242 y 243 de \cite{nla.cat-vn1819421}.
\end{proof}  

Notemos los puntos clave de este teorema, nos va a permitir \textit{trabajar} con una función medible como si fuera continua en un compacto
todo lo parecido a $\R^r$ como se quiera. 
 
\begin{teorema}(Caracterización de normalidad de Tietze)\label{teo:Tietze}
    Sea $X$ un espacio Hausdorff. Son equivalentes las siguientes afirmaciones: 
    \begin{enumerate}
        \item $X$ es normal.
        \item Para cada conjunto cerrado $A \subset X$ y para cualquier función continua 
        $f: A \longrightarrow \R$, $f$ admite una extensión continua $F:X \longrightarrow \R.$
        Además, si para todo $a \in A$ se cumple que $|f(a)| < c \in \R$, se puede elegir $F$
        de tal forma que satisfaga que $|F(x)| < c$ para todo $x\in X.$ 
    \end{enumerate}
    (Demostración en páginas 149-151 de \cite{james1966topology})
\end{teorema}

Como el ambiente actual en el que estamos trabajando 
es el espacio $(\R^d, \mathcal{T})$ que sabemos que es normal y puesto que es habitual que nuestras funciones estén definidas
en  compactos de $\R^d$, las podremos extender a $\R^d$. 


% Corolarios del artículo 
% Corolario 2.1
\begin{corolario} \label{cor:2_1}
    Para cada función $g \in \fM$ existe un subconjunto compacto 
    $K$ de $\R^d$ y $f \in \rrnn$ tal que para cualquier 
    $\epsilon > 0$ se tiene que 
    $\mu(K) > 1- \epsilon$ y para cada $x \in K$ tenemos que 
    \begin{equation}
        |f(x) - g(x) | < \epsilon,
    \end{equation}
    independientemente de la función de activación $\psi$, dimensión $d$ o medida $\mu$. 
\end{corolario}

    % Nota idea intuitiva corolario 2.1
    \reversemarginpar
    \marginpar{
        \textcolor{dark_green}{
            \textbf{Idea intuitiva corolario \ref{cor:2_1}}
        }
    }
    \marginpar{
    Este teorema corrige la carencia sobre la precisión del error que describíamos 
    en la idea intuitiva del teorema \ref{teo:2_4_rrnn_densas_M}. Podemos encontrar una red neuronal que aproxime cualquier función medible que queramos en todos los puntos del espacio que queramos.
    }

    
\begin{proof}
    Sea $\epsilon > 0$ fijo pero arbitrario.  Gracias al teorema de Lusin \ref{teo:Lusin}
    existe un subconjunto compacto $K \subset \R^d$ de medida
    $\mu(K) > 1 - \epsilon$ donde la restricción  $g_{|K}$ es continua. 

    Por otra parte, en virtud de la caracterización de Tietze 
    \ref{teo:Tietze}, 
    por estar $g_{|K}$ definida en un compacto, admite una 
    extensión continua $G:\R^d \longrightarrow \R$ tal que 
    \begin{equation}
        \begin{split}
            G_{|K} = g_{|K} .
        \end{split}
    \end{equation}

    Por ser $G$ continua en un compacto, por la densidad de las redes neuronales en compactos en $\fC$(lema \ref{lema:A_5_uniformemente_denso_compactos} ) se tiene que existirá 
     $f \in \rrnng$ tal que 
    \begin{equation}
        \sup_{x \in K} |G(x) - f(x)| < \epsilon.
    \end{equation}

    Por lo que podemos afirmar que para todo $x \in K$
    \begin{equation}
        |f(x) -g(x)| 
        \leq 
        | f(x) -G(x)| + |G(x) -g(x)|
        < \epsilon + 0 = \epsilon
    \end{equation}
    como queríamos probar.
\end{proof}


