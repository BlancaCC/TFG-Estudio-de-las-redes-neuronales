% !TeX root = ../../tfg.tex
% !TeX encoding = utf8
%
%***************************************************************
% Contenido del artículo 5: Colorarios LP
%***************************************************************
\section{Generalización a espacios $L_p$}  

Hasta ahora habíamos considerado el espacio de funciones continuas 
$\fC$ 
como subespacio dentro del espacio de funciones medibles $\fM$. 

Sin embargo ser continua es una hipótesis muy estricta que queda
notable en la amplia gama de subespacios que contienen al de 
las funciones continuas y están contenidos en el de funciones medibles. 

Es por ello que vamos a realizar una generalización de los teoremas
para espacios $L_p$. De manera intuitiva estos espacios nos van a 
permitir considerar funciones que no necesariamente sean continuas
y que incluso puedan \textit{tomar} valores puntuales \textit{que sean}
$\infty$ o $- \infty$. 

\begin{definicion}[Espacios Lp]
    Se llama espacio $L_p(\R^r, \mu)$ o simplemente $L_p$ al conjunto 
    de funciones $f \in \fM$ tales que 
    \begin{equation}
        \int |f(x)|^p d\mu < \infty. 
    \end{equation}

Se define la norma de $L_p$ como 
\begin{equation}
    \| f\|_p 
    =
    \left(\int |f(x)|^p d\mu \right)^\frac{1}{p}.
\end{equation}

La distancia asociada al espacio $L_p$ se define como 
\begin{equation}
    \rho_p(f,g) = \| f-g\|_p.
\end{equation}
\end{definicion}

% Corolario 2.2
\begin{corolario}\label{corolario:2_2_rrnn}
    Si existe un subconjunto compacto $K$ en $\R^r$ de medida
    $\mu(K) =1$ entonces $\rrnn$ es $\dlp$-denso en $L_p(\R^r, \mu)$
    para cualquier $p \in [1,\infty)$, independientemente de 
    $\psi$, $r$ o $\mu$.
\end{corolario}
\begin{proof}
    Se quiere probar que para cualquier $g \in L_p$ y 
    $\epsilon >0$ existe un $f \in \rrnn$ tales que 
    \begin{equation}
        \dlp(f,g) <\epsilon.
    \end{equation}   
    
    Por pertenecer $g$ a $L_p$ existe una constante $M$ real positiva
    los suficientemente grande 
    tal que si definimos la función $h =g 1_{|g|<M}$ esta satisface 
    que
    \begin{equation}\label{eq:corolario_2_2:h_compacto}
        \dlp(g,h) < \frac{\epsilon}{3}.
    \end{equation}
    
    Además como $h$ es una función acotada de $L_p$, podemos encontrar
    una función $s$ continua que es límite de una sucesión de
    funciones simples 
    ( pag 241-242,  teoremas 55C y 55D \cite{nla.cat-vn1819421})
    y la cual cumple que 

    \begin{equation}\label{eq:corolario_2_2:s_continua}
        \dlp(h,s) < \frac{\epsilon}{3}.
    \end{equation}

    Por el teorema \ref{teo:2_4_rrnn_densas_M}, al estar en un compacto $K$ y por ser $\rrnn$ uniformemente
    denso en compactos hay una $f \in \rrnn$ la cual cumple que
    \begin{equation}
        \sup_{x \in K} |f(x) -s(x)|^p 
        <
         \left( \frac{\epsilon}{3}\right) ^p.
    \end{equation}
    
    Y por hipótesis $\mu(K) =1$ y definición de la distancia $\dlp$ 
    se tiene la siguiente desigualdad: 

    \begin{equation} \label{eq:corolario_2_2:cota_rrnn}
        \dlp(f,s) = 
        \left(\int |f(x) - s(x)|^p d\mu \right)^\frac{1}{p}
        \leq 
        \left(\int  \left( \frac{\epsilon}{3}\right) ^p d\mu \right)^\frac{1}{p}
        = \left( \mu(K)  \left(\frac{\epsilon}{3} \right)^p\right) ^\frac{1}{p}
        = \frac{\epsilon}{3}.
    \end{equation}

    Gracias a la desigualdad triangular y las desigualdades
    (\refeq{eq:corolario_2_2:cota_rrnn})
    (\refeq{eq:corolario_2_2:h_compacto})
    (\refeq{eq:corolario_2_2:s_continua})

    \begin{equation}
        \dlp(f,g) 
        \leq
            \dlp(f,s)
            +\dlp(s,h)
            + \dlp(h,g)
        < 
        \frac{\epsilon}{3} + \frac{\epsilon}{3} + \frac{\epsilon}{3}
        = \epsilon.
    \end{equation}
Probando con ello lo buscado. 
\end{proof}  

% Corolario 2.3
\begin{corolario}
    Si $\mu$ es una medida de probabilidad en $[0,1]^r$
    entonces 
    $\rrnn$ es $\dlp$-denso en 
    $L_p([0,1]^r, \mu)$ para todo $p \in [1, \infty)$,
    independientemente de $\psi, r, \mu$. 
\end{corolario}
\begin{proof}
    Es consecuencia directa del corolario previo \ref{corolario:2_2_rrnn}
    donde para este caso particular $K = [0,1]^r$ un compacto
    de $\R^r$
    que cumple que $\mu(K) = 1.$
\end{proof}

%Corolario 2.4 
\begin{corolario} \label{corolario:2_4_conjunto_finito}
    Sea $\mu$ una una medida que evalúa a uno un conjunto 
    finito de puntos, 
    entonces, para cualquier función medible $g \in \fM$
    y sea cual sea $\epsilon >0$ 
    existe $f \in \rrnn$ la cual cumple que 
    \begin{equation}
        \mu\{ 
            x:
            |f(x) - g(x)| 
            < \epsilon
        \}
        = 1.
    \end{equation}

\end{corolario}
\begin{proof}
    Por el teorema \ref{teo:2_4_rrnn_densas_M} existirá una 
    $f \in \rrnn$ tal que para cualquier 
    $\epsilon_1, \epsilon_2 >0$ se cumpla que 
    $\mu \{x: |f(x) - g(x)| > \epsilon_1\} < \epsilon_2.$
    Sea $O$ el conjunto de puntos tal que $\mu(O) = 1.$
    Por ser finito $O$ podemos encontrar
    \begin{equation} \label{eq:2_4:definicion_epsilon}
        \delta = \min_{x \in O} \{ 
            \mu(x) : \mu(x)>0
        \}. 
    \end{equation}

    Sin pérdida de generalidad tomamos $\epsilon < \delta$ y entonces
    para cualquier $f$ que cumpla que 
    \begin{equation}
        \dist(f,g) = \epsilon
    \end{equation}
    por cómo se define la distancia de una medida
    \begin{equation}
        \dist(f,g) =  \inf 
        \{
           \epsilon > 0:
           \mu\{ 
            x:
            |f(x) - g(x)| 
            > \epsilon
        \}
        < \epsilon
        \}
    \end{equation}
    y la forma de tomar $\epsilon$ en (\refeq{eq:2_4:definicion_epsilon}) 
    tiene que $\mu\{ 
        x:
        |f(x) - g(x)| 
        > \epsilon
    \} = 0.$

    Es decir probando con ello que 
    \begin{equation}
        \mu\{ 
            x:
            |f(x) - g(x)| 
            < \epsilon
        \}
        = 1.
    \end{equation}
\end{proof}

Nótese que con este corolario lo que se está indicando es que en 
conjunto finito se puede encontrar una red neuronal
converge de manera exacta en esos puntos. 

\begin{definicion}[Función Booleana]
    Sea 
    \begin{equation}
        B^r = \{
            (x_1, ..., x_r) : x_i \in \{0,1\}, 
            \text{ para todo } i \in \{1,..., r\}
            \}.
    \end{equation}

    Se dice $f$ es una función Booleana 
    si formalmente esta definida de $f:B^r \longrightarrow B$. 
\end{definicion}
Ejemplo conocidos son la función $or: B^r \longrightarrow B$  que vale 
uno si alguno de su entrada es uno y la función 
$and: B^r \longrightarrow B$
que se define como $and(x_1, ..., x_r) = \prod_{i=1}^r x_i.$

% Corolario 2.5  
\begin{corolario}
    Para cada función Booleana $g: B^r \longrightarrow B$ y 
    cada $\epsilon >0$ existe una red neuronal
    $f \in \rrnn$ tal que 
    \begin{equation}
        \max_{x \in \{ 0,1\}^r} |g(x) - f(x)|
        < \epsilon.
    \end{equation}
\end{corolario}
\begin{proof}
    Se define la función $\mu : \R^r \longrightarrow [0,1]$ de la forma que 
    \begin{equation}
        \mu(x) = 
      \left \{
    \begin{aligned}
      \frac{1}{2^r} \quad &\text{ si } x \in B^r \\
      0 \quad & \text{ si } x \notin B^r 
    \end{aligned}
  \right .
    \end{equation}

    Se tiene que $\mu$ es una medida ya que cumple que 
    \begin{enumerate}
        \item Hipótesis de acotación: $0 \leq \mu(A) \leq 1$ para $A \in \mathcal{P}(\R^r).$
        \item Probabilidad del vacía es nula y la del  total la unidad. 
        \item La probabilidad de la unión es la suma de la probabilidades. 
        \begin{equation}
            P\left(
                \cup_{i=1}^n A_i
            \right)
            = \sum_{i=1}^n P(A_i).
            \quad
            \forall A_i \in  \mathcal{P}(\R^r).
        \end{equation}
    \end{enumerate}  

    Como la cardinalidad de $B^r$ es $2^r$, es decir finita
    podemos aplicar el corolario \ref{corolario:2_4_conjunto_finito}
    y entonces sabemos que  existe una $f\in \rrnn$ tal que 
    \begin{equation}
            \mu\{ 
                x:
                |f(x) - g(x)| 
                < \epsilon
            \}
            = 1,
    \end{equation} 
    es decir que 
    \begin{equation}
        \max_{x \in \{ 0,1\}^r} |g(x) - f(x)|
        < \epsilon
    \end{equation}
    como queríamos probar. 
\end{proof}