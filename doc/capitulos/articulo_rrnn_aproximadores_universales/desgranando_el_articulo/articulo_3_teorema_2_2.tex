% !TeX root = ../../tfg.tex
% !TeX encoding = utf8
%
%***************************************************************
% Contenido del artículo 3: Avanzamos en la generalización
%***************************************************************

% Teorema 2.2 
\begin{teorema}\label{teo:2_2_denso_funcion_continua}
    Para cualquier función continua no constate $G$, $r \in \N$ y
    medida de probabilidad $\mu$ o $(\R^r, B^r)$, 
    se tiene que $\pmcg$ es $\dist$-denso en $\fM$. 
\end{teorema} 
\begin{proof}
    Debemos probar que para cualquier función $f \in \fM$ existe una 
    sucesión de funciones $\{h_n\}_{n\in \N}$ contenida en $\pmcg$ y 
    cumpliendo que $\dist(h_n, f) \longrightarrow 0.$

    Consideramos cualquier $f \in \fM$,
    por el lema \ref{lema:A_1_C_es_denso_en_M} sabemos que $\fC$ es $\dist$-denso en $\fM$; 
    es decir, existirá un sucesión $\{f_n\}_{n\in \N}$ de funciones de $\fC$ convergente a 
    $f$.  
    
    Por otra parte sabemos por el teorema \ref{teo:TeoremaConvergenciaRealEnCompactosDefinicionesEsenciales}, 
    que $\pmcg$ es uniformemente denso por compactos en $\fC$, luego en cualquier compacto 
    $K \subset \R^r$ existirá una sucesión (con $n$ fijo) $\{g(n)_m \} _{m \in \N}$ convergente 
    a $f_n$, el término n-ésimo de la sucesión convergente a $g$. 

    Así pues, denotando como $h_n$ al término $g(n)_n$, obtenemos una sucesión de funciones 
    en $\fM$ que converge uniformemente en compactos a $f$ y por el lema \ref{lema:2_2_convergencia_uniforme_en_compactos}
    tenemos que $\dist(h_n, f) \longrightarrow 0$ como queríamos probar.     
\end{proof}

% --- Faltan por demostrar -----
% Lema A.2 
\begin{lema}\label{lema:a_2_paso_previo_denso}
    Sea F una función de activación continua y $\psi$ una \textbf{función de activación} arbitraria. 
    Para cualquier $\epsilon > 0$ existe un elemento $H_{\epsilon}$ de $\sum^1(\psi)$ cumpliendo que
    \begin{equation}
        \sup_{\lambda \in \R} | F(\lambda) - H_{\epsilon}(\lambda) | < \epsilon.
    \end{equation}
\end{lema} 
\begin{proof}
    Procedamos a realizar la siguiente prueba constructiva. 
    Tomamos fijo pero arbitrario un $\epsilon > 0,$ que sin pérdida de generalidad
    supondremos menor que uno 
    \footnote{En caso de ser mayor, se tomará cualquier otro menor que la unidad y la función resultante será igual de válida.}.
    Para que la $H_\epsilon$ pertenezca a $\sum ^1 (\psi)$ deberá de ser de la 
    forma $\sum^{q-1}_{j=1} b_j \psi( A_j(\lambda))$
    debemos encontrar por ende el número de sumatorias $q-1$ y esa misma cantidad de constantes reales $b_j$ y funciones afines $A_j$. 
    
    La idea subyacente consiste en lo siguiente, puesto que estamos trabajando con funciones estrictamente monótonas que bastará definir conocer el comportamiento de $F$ dentro de un dominio cerrado y acotado. 
    
    Tomamos como $q$ a cualquier número natural que cumpla que 
    \begin{equation}
        \frac{1}{q} < \frac{\epsilon}{2}.
    \end{equation}

    Fijaremos para cada $j \in \{1,2, ...,q-1\}$ los coeficientes  $\beta_j$ como $\frac{1}{q}$. 

    Seleccionamos la constante real $M>0$ de tal forma que 
    \begin{equation}
        \psi(-M) < \frac{\epsilon}{2}q 
        \quad \text{ y } \quad
        \psi(M) > 1 - \frac{\epsilon}{2}q.
    \end{equation} Sabemos que esta constante existe ya que por ser $\psi$ una función de activación satisface que 
    $\lim_{\lambda \longrightarrow \infty} \psi(\lambda) = 1$ y que  $\lim_{\lambda \longrightarrow -\infty} \psi(\lambda) = 0$, 

    Luego existirá una constante $M_1$ positiva tal que a partir de ella cualquier otra constante $n_1$ mayor o igual satisfaga que 
    $\psi(n_1) > 1 - \frac{\epsilon}{2}q$. También existirá una constante $M_2$ positiva tal que a partir de ella cualquier otra constante $n_2$ mayor o igual satisfaga que 
    $\psi(-n_2) < \frac{\epsilon}{2}q$.

    Podemos tomar como $M$ al máximo de $M_1$ y $M_2$.   

    Seleccionaremos ahora los siguientes puntos del dominio
    \begin{equation}
        r_j = \sup \left\{ \lambda: F(\lambda) = \frac{j}{q} \right\},
         \text{ con } j \in \{1, ..., q-1\}, 
         \quad \text{ y } \quad
        r_q = \sup \left\{ \lambda: F(\lambda) = 1 - \frac{1}{q} \right\}. 
    \end{equation}
    Que por ser $F$ continua sabemos que existen. 

    Procedemos ahora a definir las distintas aplicaciones afines. 
    Para cualquier reales $s,r$ que cumplan que $r < s$ sea $A_{rs}\in A^1$ la única aplicación afín que satisface que 
    \begin{equation}
        A_{rs}(r) = M \text{ y }  A_{rs}(s) = - M. 
    \end{equation} 
    
    Se tiene que 
    \begin{equation}
        H_\epsilon(\lambda) = \sum^{q-1}_{j=1} b_j \psi( A_j(\lambda))
    \end{equation}
    así definida cumple por 
    %TODO falta por probar que se cumple que cada subintervalo (r_j,r_{j+1}] y en los semi abiertos. 
\end{proof}      

% Teorema 2.3
\begin{teorema}
    Para cualquier función de activación $\psi$, $r$ natural positivo y
    medida de probabilidad $\mu$ en $(\R^r, B^r)$, 
    se tiene que $\rrnng$ es uniformemente denso en compactos
    en $\fC$ y denso en $\fM$ de acorde a la distancia $\dist$. 
\end{teorema}
\begin{proof}
    En virtud del lema \ref{lema:2_2_convergencia_uniforme_en_compactos} y del 
    teorema \ref{teo:2_2_denso_funcion_continua} basta con probar que 
    $\rrnng$ es uniformemente denso en compactos de $\sum \prod^r(F)$, 
    donde $F$ es una función de activación continua 
    \footnote{el razonamiento 
    por el que con esta hipótesis es suficiente es idéntico al realizado para la 
    demostración del teorema \ref{teo:2_2_denso_funcion_continua}.}.

    Para ello basta ver que cualquier función de la forma $\prod_{k=1}^l F(A_k(\cdot))$
    puede ser uniformemente aproximada por una una sucesión de funciones de $\rrnng$.

    Fijamos un $\epsilon > 0$  de manera arbitraria. 
    Gracias a la continuidad de la norma y de la operación multiplicación, existirá un $\delta >0$
    tal que para cualesquiera números reales $0 \leq a_k, b_k \leq 1,$ con $k \in \{1,...,l\}$ 
    se satisfagan que $|a_k -b_k| < \delta$ se cumple que 
    \begin{equation} \label{eq:teorema_2_3__1}
        \left| 
            \prod^l_{k=1} a_k - \prod^l_{k=1} b_k 
        \right| 
        < 
        \epsilon.
    \end{equation}

    Por el lema \ref{lema:a_2_paso_previo_denso} existe una función 
    $H_{\delta}(\cdot) = \sum_{t=1}^T \beta_t \psi(A_t(\cdot))$
    cumpliendo que 

    \begin{equation}
        \sup_{\lambda \in \R} |F(\lambda) - H_{\delta}(\lambda) | < \delta.
    \end{equation}

    Se satisface con la cota suficiente de la desigualdad \refeq{eq:teorema_2_3__1} por lo que 
    resulta 
    \begin{equation}\label{eq:teorema2_3__3}
        \sup_{x \in \R^r} 
        \left| 
            \prod ^l_{k=1} F(A_k(x))
            -
            \prod ^l_{k=1} H_\delta(A_k(x))
        \right| 
        < 
        \epsilon.
    \end{equation} 
    
    Puesto que $H_\delta$ es de la forma  $\sum_{t=1}^T \beta_t \psi(A^1_t(\cdot))$ 
    y porque $A^1_t(A_k(\cdot)) \in A^r$ se tiene por la desigualdad \ref{eq:teorema2_3__3} que 
    $\prod ^l_{k=1} H_\delta(A_k(\cdot)) \in \rrnng.$

    Por lo tanto como  $\prod ^l_{k=1} F(A_k(\cdot))$ puede ser 
    aproximado por elementos de $\rrnng$ probando con ello lo buscado. 
\end{proof} 

%% Falta por probar 
% Teorema 2.4
\begin{teorema}
    Para cualquier función de activación $\psi$, $r \in \N$ y
    medida de probabilidad $\mu$ o $(\R^r, B^r)$, 
    se tiene que $\rrnn$ es uniformemente denso en compactos
    en $\fC$ y denso en $\fM$ de acorde a la distancia $\dist$. 
\end{teorema}