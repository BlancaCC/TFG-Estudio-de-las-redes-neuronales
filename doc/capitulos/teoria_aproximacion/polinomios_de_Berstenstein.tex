% !TeX root = ../../tfg.tex
% !TeX encoding = utf8
%
%*******************************************************
% Polinomois de Bernstein
%*******************************************************

\section{Polinomios de Bernstein}\label{ch:Bernstein}  

%% Resumen capítulo 
En esta seción introduciremos los polinomios de Bernstein;   que vistos como una serie nos asegurarán una convergencia uniformemente a cualquier función continua en un compacto y serán esenciales para nuestra prueba del teorema de Stone-Weiertrass.  

Comenzaremos recordando el Teorema del Binomio de Newton. 

%% Teorema Binomio de Newton

\begin{teorema}[Binomio de Newton]
    Cualquier potencia de un binomio $x+y$ con $x,y \in \R$,  puede ser expandido en una suma de la forma
    \[(x+y)^n = \sum_{k=0}^n \binom{n}{k} x^{k}y^{n-k}\]
\end{teorema}  

%%% Idea intuitiva y desigualdad 
Tomando ahora para esta igualdad $x \in \R, y= 1-x$ se tiene que 

\begin{equation}\label{eq:uno_igual_binomio}
    1 = (x+ (1-x))^n = \sum_{k=0}^n \binom{n}{k} x^{k} (1-x)^{n-k}
\end{equation}

Dada cualquier función $f$ definida en $x$ podríamos multiplicar la ecuación 
\eqref{eq:uno_igual_binomio} por $f(x)$ resultando. 

\begin{equation}\label{eq:f_igual_binomio}
    f(x) = \sum_{k=0}^n f(x) \binom{n}{k} x^{k} (1-x)^{n-k}
\end{equation} 

Y tomando como dominio $I=[0,1]$ de $f: I \longrightarrow \R$,
 nos encontramos
frente a una ecuación muy sugerente para introducir $B_n(x)$, el \textit{Polinomio n-ésimo  de Bernstein }. 
El cual pretende  aproximar la función $f$ a través de los puntos $\frac{k}{n}$ con $n \in \N$ fijo
y $k \in \{0,...,n \}.$

\begin{definicion}[Polinomios de Bernstein] \label{def:Bernstein}
    Dada cierta función $f: [0,1] \rightarrow \R$, se define el n-ésimo polinomio de Bernstein para $f$ como 

    $$B_n(x) = B_n(x;f)=\sum_ {k=0}^{n} \left( f \left( \frac{k}{n} \right) \binom{n}{k} x^k (1-x)^{n-k} \right) .$$

\end{definicion}

Faltaría por ver si efectivamente nuestro polinomio construido
 \textit{aproxima lo suficientemente bien} a la $f$ originaria. 
Basándonos en la igualdad \eqref{eq:f_igual_binomio} y 
la diferencia entre $f(x)$ y $B_n(x)$ se concluye que

%\begin{equation}
%    f(x)-B_n(x) = \sum_{k=0}^n \left(f(x) - f \left( \frac{k}{n} \right)\right)
%    \binom{n}{k} x^{k} (1-x)^{n-k}
%\end{equation} 

%Tomando valor absoluto resulta 
\begin{equation} \label{eq:berstein_diferencia}
    |f(x)-B_n(x)| = \sum_{k=0}^n \left|f(x) - f \left( \frac{k}{n} \right)\right|
    \binom{n}{k} x^{k} (1-x)^{n-k}
\end{equation} 

Ante tal igualdad la intuición ya nos
hace pensar que sea convergente al aumenta el tamaño de la partición.
 En efecto, en nuestro sucesivo teorema, nos cercioraremos que \ref{def:Bernstein}
 es uniformemente convergente a $f$ en un compacto. 

\begin{teorema}[Teorema de aproximación de Bernstein]\label{teo:aproximacion_bernstein}

    Sea $f$ una función continua de un intervalo $I = [0,1]$ con imágenes en los reales. 
    La secuencia de polinomio de Bernstein
    \ref{def:Bernstein} converge uniformemente a $f$ en $I.$
    
\end{teorema}
Recordaremos antes la definición de convergencia uniforme: 

\begin{definicion}[Convergencia uniforme para funciones reales]

    Dado $E$ un conjunto y $\{f_n\}_{n \in \N}$ una sucesión de funciones de $E$
     a los reales; se dice 
    que dicha sucesión converge uniformemente si para cualquier $\varepsilon > 0$ existe un número natural $m$ tal que 
    para todo $x   \in E$ y cualquier natural $n$ que cumpla $n \geq m$ se tiene que 

    \begin{equation*}
        |f_n(x) - f(x) | < \varepsilon
    \end{equation*}
    
\end{definicion}

% Demostración de la convergencia de los polinomios de Bernstein
Comencemos pues con la demostración del teorema \ref{teo:aproximacion_bernstein}.
\begin{proof}
    
    Para cualquier $\varepsilon > 0$ queremos probar que existe un $m_\varepsilon  \in \N$ tal que para 
    todo $x \in I$ e $n \geq m_\varepsilon$  se tiene que 
    $|f(x) - B_n(x)| < \varepsilon$.
    
     Para ello por estar $f$ definida en un intervalo, 
    se tienen dos consecuencias claves: 
    \begin{enumerate}
        \item Está acotada, supongamos por $M \in \R$, esto es $|f(x)| \leq M$. \label{consecuencia:M}
        \item En virtud del teorema de Heine-Cantor $f$ es uniformemente continua, es decir; por estar $f$ definida en un compacto,  para cualquier $\varepsilon >0$ existirá un $\delta_\varepsilon$
        tal que para cualesquiera $x,y \in I$ que cumplan $|x-y| < \delta_\varepsilon$ entonces $|f(x)-f(y)| < \varepsilon$. \label{consecuencia:delta}
    \end{enumerate}
    %% Cota 2M para  cada sumando
    En virtud de la consecuencia \refeq{consecuencia:M}. 
    Dado $N \in  \N$ fijo pero arbitrario, para cualquier $k \in \{1, ..., N\}$ se tiene que
    $\frac{k}{N} \in I$ y tomando $x \in I$ podemos acotar por la desigualdad triangular

    $$\left|f(x)- f\left( \frac{k}{N} \right) \right| \leq |f(x)| + \left|f \left( \frac{k}{N}\right) \right|\leq 2M$$  

    Por lo que 

    \begin{equation*}
        |f(x)-B_n(x)| \sum_{k=0}^n \left|f(x) - f \left( \frac{k}{n} \right)\right| \leq
     \binom{n}{k} x^{k} (1-x)^{n-k}
    \end{equation*}

    Puesto que tenemos que $f$ acotada por $M$ y es uniformemente continua, para valores de $k$ tales que $\frac{k}{n}$ 
    esté próxima a $x$, tal término de la sumatoria será pequeño por la continuidad de $f$ en $x$. Por otro lado
    si está lo suficientemente alejado, tan solo podremos acotar tal término por $2M$. 

    Separaremos pues nuestra sumatoria en los siguientes dos conjuntos.  
    \begin{equation*}
        |f(x)-B_n(x)| \sum_{k=0}^n \left|f(x) - f \left( \frac{k}{n} \right)\right| \leq
     \binom{n}{k} x^{k} (1-x)^{n-k}
     \leq \sum_{k=0}^n 2M 
    \binom{n}{k} x^{k} (1-x)^{n-k}
    \end{equation*}

    %% Amago de cota 

    Encauzados nuevamente por la intuición de que la diferencia debe decrecer al aumentar $N$,
     el tamaño de la partición;
    escribiremos la ecuación anterior en involucrando a $N$. 

    %% Desarrollo hasta llegar a la ecuación de raiz de N


    El siente paso natural será acotar la sumatoria entera por alguna expresión que decrezca al aumentar N, para ello jugaremos un poco con la propiedades de los coeficientes binomiales. 
    TODO : es necesario introducir aquí la inecuaciónde la N, pero ahora no ves clara la relación, conviene 
    y quizás de aquí surgen la necesidad de la partición. 
   
    %%% propiedades coeficientes binomial 

    Tengamos ahora presente las siguientes igualdades 
    \begin{equation} \label{eq:binomio_menos_uno}
        \binom{n-1}{k-1} = \frac{(n-1)!}{(k-1)! (n-1-(k-1))!} = \frac{k}{n} \binom{n}{k}
    \end{equation}
    \begin{equation} \label{eq:binomio_menos_dos}
        \binom{n-2}{k-2} = \frac{(n-2)!}{(k-2)! (n-2-(k-2))!} = \frac{k(k-1)}{n(n-1)} \binom{n}{k}
    \end{equation}

    Partiendo de la igualdad \eqref{eq:uno_igual_binomio}:
    \begin{equation}
        1 = (x+ (1-x))^n = \sum_{k=0}^n \binom{n}{k} x^{k} (1-x)^{n-k}
    \end{equation}

    Reemplazamos la $n$ por $n-1$ y la $k$ por $j$ y tenemos 
    \begin{equation}
        1 = \sum_{j=0}^{n-1} \binom{n-1}{j} x^{j} (1-x)^{(n-1)-j}
    \end{equation}
    Multiplicamos por $x$ y aplicamos la igualdad \eqref{eq:binomio_menos_uno} resultando 

    \begin{equation}
        x = \sum_{j=0}^{n-1} \frac{j+1}{n} \binom{n}{j+1} x^{j+1} (1-x)^{(n-(j+1)}
    \end{equation}

    Renombramos $k= j+1$, por lo que resulta
    \begin{equation}
        x = \sum_{k=1}^{n} \frac{k}{n} \binom{n}{k} x^{k} (1-x)^{n-k}
    \end{equation}

    Como el término con $k=0$ es nulo podemos añadirlo a la sumatoria
    
    \begin{equation} \label{eq:desarrollo_binomio_uno}
        x = \sum_{k=0}^{n} \frac{k}{n} \binom{n}{k} x^{k} (1-x)^{n-k}
    \end{equation}

    %------------------ caso 2, no te confundas --------------------
    Haremos ahora un razonamiento similar sustituyendo $n$ por $n-2$

    Partiendo de \eqref{eq:uno_igual_binomio} se tiene que 
    \begin{equation}
        1 = (x+ (1-x))^n = \sum_{k=0}^n \binom{n}{k} x^{k} (1-x)^{n-k}
    \end{equation}

    Reemplazamos la $n$ por $n-2$ y la $k$ por $j$ y tenemos 
    \begin{equation}
        1 = \sum_{j=0}^{n-2} \binom{n-2}{j} x^{j} (1-x)^{(n-2)-j}
    \end{equation}
    Multiplicamos por $x^2$ y aplicamos la igualdad \eqref{eq:binomio_menos_dos} resultando 

    \begin{equation}
        x^2 = \sum_{j=0}^{n-2} \frac{(j+2)(j+1)}{n(n-1)} \binom{n}{j+2} x^{j+2} (1-x)^{(n-(j+2)}
    \end{equation}

    Renombramos $k= j+2$, por lo que resulta
    \begin{equation}
        x^2 = \sum_{k=2}^{n} \frac{k(k-1)}{n(n-1)} \binom{n}{k} x^{k} (1-x)^{n-k}
    \end{equation}

    Como con los términos $k=0$ y $k=1$ se anula, podemos añadir dichos índices sin modificar la suma 
    
    \begin{equation}
        x^2 = \sum_{k=0}^{n} \frac{k(k-1)}{n(n-1)} \binom{n}{k} x^{k} (1-x)^{n-k}
    \end{equation}

    Podemos reescribir la ecuación resultando: 

    \begin{equation} \label{eq:desarrollo_binomio_dos}
      (n^2 - n)  x^2 = \sum_{k=0}^{n} (k^2 - k) \binom{n}{k} x^{k} (1-x)^{n-k}
    \end{equation}
    
    
%--------------- fin de las igualdades del binomio de Newton 


%%% -- MOVER ESTO DE SITIO
\begin{equation*}  \label{eq:Bernstein_caso_a_acotar}
    \begin{split}
    & \sum_{k \in \mathcal{B}_{x,N}} 2M \binom{N}{k} x^k (1-x) ^{N-k} \\
    & = 2M  \sum_{k \in \mathcal{B}_{x,N}}  \frac{(x- \frac{k}{N})^2}{(x- \frac{k}{N})^2} \binom{N}{k} x^k (1-x) ^{N-k} \\
    & \leq 2M \sqrt{N} \sum_{k \in \mathcal{B}_{x,N}}  (x- \frac{k}{N})^2 \binom{n}{k} x^k (1-x) ^{N-k} \\
\end{split}
\end{equation*}


%%% copiad de lo que había arriba
Recordemos que nuestro objetivo era acotar \ref{eq:Bernstein_caso_a_acotar}

Para ello vamos a sumar las dos expresiones que hemos obtenido
 \eqref{eq:desarrollo_binomio_uno} y \eqref{eq:desarrollo_binomio_dos}

 resultando 
 \begin{equation} 
    (n^2 - n)  x^2 + nx= \sum_{k=0}^{n} ((k^2 - k)+k) \binom{n}{k} x^{k} (1-x)^{n-k}
  \end{equation}
  Dividimos todo entre $n$. 
  \begin{equation} \label{eq:binomio_tras_suma}
    (1 - \frac{1}{n})  x^2 + \frac{1}{n}x= \sum_{k=0}^{n} \left( \frac{k}{n} \right)^2 \binom{n}{k} x^{k} (1-x)^{n-k}
  \end{equation}

  A continuación sumamos a la igualdad \eqref{eq:binomio_tras_suma} la ecuación \eqref{eq:uno_igual_binomio} multiplicada por $x^2$ y la ecuación \eqref{eq:desarrollo_binomio_uno}
  multiplicada por $-2x$ resultando: 


  \begin{equation} 
    (1 - \frac{1}{n} + 1 -2)  x^2 + \frac{1}{n}x= \sum_{k=0}^{n} \left( \left( \frac{k}{n} \right)^2 + x^2 -2x \right) \binom{n}{k} x^{k} (1-x)^{n-k}
  \end{equation}

  Factorizando en ambos miembros resulta

  \begin{equation} \label{eq:binomio_segunda_suma}
     \frac{1}{n} x (1-x)= \sum_{k=0}^{n}  \left( x-\frac{k}{n} \right)^2  \binom{n}{k} x^{k} (1-x)^{n-k}
  \end{equation}

  Gracias a \eqref{eq:binomio_segunda_suma} acabos de encontrar una cota para 
  \eqref{eq:Bernstein_caso_a_acotar}

  \begin{equation}
    2M \sqrt{N} \sum_{k \in \mathcal{B}_{x,N}}  (x- \frac{k}{N})^2 \binom{N}{k} x^k (1-x) ^{N-k}  = 2M \sqrt{N} \frac{1}{N} x (1-x) = 2M  \frac{1}{\sqrt{N}} x (1-x)
  \end{equation}

  Además como $x (1-x)$ alcanza un máximo absoluto en $x=\frac{1}{2}$ luego concluimos que 

  \begin{equation}
    |f(x)-B_N(x)| = \sum_{k=0}^N \left| f(x) - f \left(\frac{k}{N} \right) \right| \binom{n}{k} x^k (1-x) ^{n-k} \leq M \frac{1}{2 \sqrt{N}} 
\end{equation}

    Con $M = max \{ |f(x)| : x \in I\}.$

    Por que tomando como $m_\epsilon = \lceil M \frac{1}{2 \sqrt{ \epsilon }} \rceil$
    habremos probado la convergencia uniforme buscada. 

\end{proof}

 
 
\endinput 


Sin pérdida de generalidad supondremos que $I=[0,1]$, como veremos esto no es restrictivo ya que 
si $I$ fuera un intervalo cerrado existiría un homeomorfismo $H$ tal que $H^*(I)=[0,1]$ y podríamos
trabajar con $H \circ f$ la cual respetaría todas los argumentos utilizados en la demostración. 

Si $I$ fuera un abierto consideraríamos su cierre y aplicaríamos el razonamiento anterior. 
De esta manera los supremos e ínfimos se mantendrían, ahora como mínimos y máximos y no se alteraría
de ninguna manera la continuidad. 

Tras la aclaración anterior podemos comenzar.

%% borrar
Fijado un $x$ del dominio, se tienen las siguientes particiones de índices: 
    
$$\mathcal{A}_{x,N} = \{ k | k \in \{1, ..., N\} \text{ y }  |x- \frac{k}{N}| < \delta_\varepsilon \}$$

Donde el $\delta_\varepsilon$ se ha obtenido de la observación 2 tomando como $\varepsilon$ el 
buscado para la convergencia uniforme. 

Sea $\varepsilon > 0$ y tomemos $\delta_ \varepsilon$ el delta de la definición de uniformemente continuo.

Por otro lado se define
$$\mathcal{B}_{x,N} = \{1, ..., N\} - \mathcal{A}_{x,N}$$


Podemos elegir $m$ de manera conveniente de tal forma que 

$$ n \geq sup \left\{ (\delta_\varepsilon) ^{-4}, \frac{M^2}{\varepsilon^2}\right\}$$


y agruparemos los términos de la sumatoria en dos partes, para los que 
$|x - \frac{k}{n}| < n^{ -\frac{1}{4}} \leq \delta_\varepsilon$. 

Para éstos,  se tiene por Newton  

\begin{equation*}
    \sum_{k=1}^n   \varepsilon \binom{n}{k} x^k (1-x)^{n-k} \leq \varepsilon \sum_{k=1}^n \binom{n}{k} x^k (1-x)^{n-k} =  \varepsilon
\end{equation*}

Para el resto de términos, aquellos cuya $k$ cumpla que $|x - \frac{x}{n}| \geq n ^\frac{-1}{4}$, se tiene que 
$|x - \frac{x}{m}| \geq n ^\frac{-1}{2}$. 

Queda el resto de subíndices resulta acotada por, deberemos de ver que para una determinada N, 
esa desigualdad se queda en épsilon
\begin{equation*}
    \sum_{k \in \mathcal{B}_{x,N}} 2M \binom{n}{k} x^k (1-x) ^{n-k} \\
\end{equation*}
